\input{../../shared/preamble.tex}

\hypersetup{pdftitle={Компьютерные методы небесной механики - Метод Адамса (9-ый семестр, 2021)}}

\title{Компьютерные методы небесной механики}
\subtitle{Метод Адамса}
\author{Павел Соболев}
\date{23 сентября 2021}

\begin{document}

\frame{\titlepage}

\begin{frame}
\frametitle{Линейные многошаговые методы}
Рассмотрим задачу с начальными данными в форме

\su
\begin{equation}
  y' = f(t, y), \quad y(t_0) = y_0.
\end{equation}

Результат аппроксимации решения $ y(t) $:

\su
\begin{equation}
  y_i \approx y(t_i), \, \text{где} \;\, t_i = t_0 + ih.
\end{equation}

Линейный многошаговый метод:

\su
\begin{equation}
\begin{gathered}
  y_{n+s} + a_{s-1} \cdot y_{n+s-1} + a_{s-2} \cdot y_{n+s-2} + \cdots + a_0 \cdot y_n = \\
  = h \cdot (b_s \cdot f(t_{n+s}, y_{n+s}) + b_{s-1} \cdot f(t_{n+s-1}, y_{n+s-1})) \, + \\
  + \cdots + b_0 \cdot f(t_n, y_n)).
\end{gathered}
\end{equation}

\end{frame}

\begin{frame}
\frametitle{Примеры явных методов}

Метод Эйлера ($s = 1$, $a_{s-1} = -1$, $b_s = 0$):

\su
\begin{equation}
  y_{n+1} = y_n + h f(t_n, y_n);
\end{equation}

Двухшаговый метод Адамса--Башфорта \\
($s = 2$, $a_{s-1} = -1$, $b_s = 0$):

\su
\begin{equation}
  y_{n+2} = y_{n+1} + \frac{3}{2} h f(t_{n+1}, y_{n+1}) - \frac{1}{2} h f(t_n, y_n);
\end{equation}

Трёхшаговый метод Адамса--Башфорта \\
($s = 3$, $a_{s-1} = -1$, $b_s = 0$):

\su
\begin{equation}
\begin{gathered}
  y_{n+3} = y_{n+2} + \frac{23}{12} h f(t_{n+2}, y_{n+2}) \, - \\
  - \, \frac{16}{12} h f(t_{n+1}, y_{n+1}) + \frac{5}{12} h f(t_n, y_n).
\end{gathered}
\end{equation}

\end{frame}

\begin{frame}
\frametitle{Коэффициенты методов Адамса--Башфорта}

Используя полиномиальную интерполяцию, находим многочлен $ p $ степени $ s - 1 $, такой что

\su
\begin{equation}
  p(t_{n+i}) = f(t_{n+i}, y_{n+i}), \quad i = 0, \ldots, s - 1.
\end{equation}

Интерполяционный многочлен Лагранжа:

\su
\begin{equation}
  p(t) = \sum_{j=0}^{s-1} \frac{(-1)^{s-j-1} f(t_{n+j}, y_{n+j})}{j! \, (s-j-1)! \, h^{s-1}} \prod_{\substack{i=0 \\ i \neq j}}^{s-1}(t - t_{n+i}).
\end{equation}

Решение уравнения $ y' = p(t) $ --- интеграл от $ p $, а значит,

\su
\begin{equation}
  y_{n+s} = y_{n+s-1} + \int_{t_{n+s-1}}^{t_{n+s}} p(t) \, dt.
\end{equation}

\end{frame}

\begin{frame}
\frametitle{Точность явных методов}

Подставляя $ p $ в (9), получаем

\su
\begin{equation}
\begin{gathered}
  b_{s-j-1} = \frac{(-1)^j}{j! \, (s-j-1)!} \int_0^1 \prod_{\substack{i=0 \\ i \neq j}}^{s-1}(u + i) \, du, \\
  j = 0, \ldots, s - 1.
\end{gathered}
\end{equation}

Замена $ f(t, y) $ на интерполяционный многочлен $ p $ даёт ошибку порядка $ h^s $. Таким образом, $s$-шаговый явный метод Адамса--Башфорта имеет глобальную ошибку $ O(h^s) $.

\end{frame}

\begin{frame}
\frametitle{Примеры неявных методов}

Обратный метод Эйлера ($s = 0$, $a_{s-1} = -1$, $b_s \neq 0$):

\su
\begin{equation}
  y_{n+1} = y_n + h f(t_{n+1}, y_{n+1});
\end{equation}

Метод трапеций ($s = 1$, $a_{s-1} = -1$, $b_s \neq 0$):

\su
\begin{equation}
  y_{n+1} = y_n + \frac{1}{2} h f(t_{n+1}, y_{n+1}) + \frac{1}{2} h f(t_n, y_n);
\end{equation}

Двухшаговый метод Адамса--Мультона \\
($s = 2$, $a_{s-1} = -1$, $b_s \neq 0$):

\su
\begin{equation}
\begin{gathered}
  y_{n+2} = y_{n+1} + \frac{5}{12} h f(t_{n+2}, y_{n+2}) + \\
  + \frac{2}{3} h f(t_{n+1}, y_{n+1} - \frac{1}{12} h f(t_n, y_n)).
\end{gathered}
\end{equation}

\end{frame}

\begin{frame}
\frametitle{Точность неявных методов}

Метод получения коэффициентов неявных методов аналогичен тому, что был у явных. Однако теперь в процессе интерполяции участвует и точка $ t_n $:

\su
\begin{equation}
\begin{gathered}
  b_{s-j} = \frac{(-1)^j}{j! \, (s-j)!} \int_0^1 \prod_{\substack{i=0 \\ i \neq j}}^s(u + i - 1) \, du, \\
  j = 0, \ldots, s.
\end{gathered}
\end{equation}

Добавление этой точки повышает точность метода до $ O(h^{s+1}) $.

\end{frame}

\begin{frame}
\frametitle{Интегрирование уравнений движения}

Уравнения движения

\su
\begin{equation}
  \frac{d\mathbf{r}}{dt} = \mathbf{v}, \quad \frac{d \mathbf{v}}{dt} = \varkappa \frac{\mathbf{r}}{r^3}
\end{equation}

интегрируются двухшаговым методом Адамса--Башфорта как

\su
\begin{equation}
  r_{i+2} = r_{i+1} + \frac{3}{2} h v_{i+1} - \frac{1}{2} h v_i;
\end{equation}

\su
\begin{equation}
  v_{i+2} = v_{i+1} + \frac{3}{2} h \varkappa \frac{r_{i+1}}{r^3} - \frac{1}{2} h \varkappa \frac{r_i}{r^3}.
\end{equation}

\end{frame}

\captionsetup{singlelinecheck=false, justification=justified}

\begin{frame}[fragile]

\begin{figure}[h!]
\begin{lstlisting}[
  caption={Реализация двухшагового метода Адамса-Башфорта}
]
# <...>
# Compute the second value of the solution
# by using the one-step Euler's method
ρ = norm(r)^3
for k in 1:N
    a = ϰ * r[k] / ρ
    r[k] += h * v[k]
    v[k] += h * a
end
# Define a couple of independent coefficients
k₁ = 3 / 2 * h; k₂ = 1 / 2 * h
# Compute the rest in two steps
for _ in 2:n
    ρₖ = norm(r)^3
    ρₖ₋₁ = norm(rₖ₋₁)^3
    # Define a couple of dependent coefficients
    k₃ = k₁ * ϰ / ρₖ
    k₄ = k₂ * ϰ / ρₖ₋₁
    for k in 1:N
        a₁ = k₃ * r[k]
        a₂ = k₄ * rₖ₋₁[k]
        rₖ₋₁[k] = r[k]
        r[k] += k₁ * v[k] - k₂ * vₖ₋₁[k]
        vₖ₋₁[k] = v[k]
        v[k] += a₁ - a₂
    end
end
# <...>
\end{lstlisting}
\end{figure}

\end{frame}

\captionsetup{justification=centering}

\begin{frame}
\frametitle{Результаты интегрирования положений}

Начальные данные:

\su
\begin{equation}
  \mathbf{r} = (1.0, 0.0), \quad \mathbf{v} = (0.0, 0.5).
\end{equation}

\begin{table}[h]
  \centering
  \caption{Сравнение результатов интегрирования положений}
  \begin{tabular}{cccc}
    \toprule
    $ h $ &
    $ n $ &
    $ r_{ab2}[1] $ &
    $ r_{ab2}[2] $ \\
    \midrule
    $ 10^{-2} $ & $ 10^2 $ & $ 0.432121746394179 $ & $ 0.37815749277595 $ \\
    \arrayrulecolor{black!40}
    \midrule
    $ 10^{-3} $ & $ 10^3 $ & $ 0.431860672712581 $ & $ 0.37796026535278 $ \\
    \midrule
    $ 10^{-4} $ & $ 10^4 $ & $ 0.431858022761150 $ & $ 0.37795824197535 $ \\
    \midrule
    $ 10^{-5} $ & $ 10^5 $ & $ 0.431857996224758 $ & $ 0.37795822169228 $ \\
    \midrule
    $ 10^{-6} $ & $ 10^6 $ & $ 0.431857995959396 $ & $ 0.37795822148942 $ \\
    \midrule
    $ 10^{-7} $ & $ 10^7 $ & $ 0.431857995956774 $ & $ 0.37795822148731 $ \\
    \arrayrulecolor{black}
    \bottomrule
  \end{tabular}
\end{table}

\end{frame}

\begin{frame}
\frametitle{Результаты интегрирования скоростей}

\begin{table}[h]
  \centering
  \caption{Сравнение результатов интегрирования скоростей}
  \begin{tabular}{cccc}
    \toprule
    $ h $ &
    $ n $ &
    $ v_{ab2}[1] $ &
    $ v_{ab2}[2] $ \\
    \midrule
    $ 10^{-2} $ & $ 10^2 $ & $ -1.3165065004310472 $ & $ 0.00568983216741340 $ \\
    \arrayrulecolor{black!40}
    \midrule
    $ 10^{-3} $ & $ 10^3 $ & $ -1.3171652194392918 $ & $ 0.00501794516416678 $ \\
    \midrule
    $ 10^{-4} $ & $ 10^4 $ & $ -1.3171719282657055 $ & $ 0.00501101126551030 $ \\
    \midrule
    $ 10^{-5} $ & $ 10^5 $ & $ -1.3171719954650160 $ & $ 0.00501094171752966 $ \\
    \midrule
    $ 10^{-6} $ & $ 10^6 $ & $ -1.3171719961370885 $ & $ 0.00501094102188871 $ \\
    \midrule
    $ 10^{-7} $ & $ 10^7 $ & $ -1.3171719961438284 $ & $ 0.00501094101492268 $ \\
    \arrayrulecolor{black}
    \bottomrule
  \end{tabular}
\end{table}

\end{frame}

\begin{frame}
\frametitle{Результаты интегрирования положений за цикл}

\begin{table}[h]
  \centering
  \caption{Сравнение результатов \\ интегрирования положений за цикл}
  \begin{tabular}{cccc}
    \toprule
    $ h $ &
    $ n $ &
    $ r_{ab2}[1] $ &
    $ r_{ab2}[2] $ \\
    \midrule
    $ 10^{-2} $ & $ 271 $ & $ 1.0509719048610 $ & $ -0.16457519920592 $ \\
    \arrayrulecolor{black!40}
    \midrule
    $ 10^{-3} $ & $ 2714 $ & $ 1.0000767603444 $ & $ -0.00124383331363 $ \\
    \midrule
    $ 10^{-4} $ & $ 27141 $ & $ 1.0000000820458 $ & $ -0.00000190353812 $ \\
    \midrule
    $ 10^{-5} $ & $ 271408 $ & $ 1.0000000001267 $ & $ -0.00000058425521 $ \\
    \midrule
    $ 10^{-6} $ & $ 2714081 $ & $ 1.0000000000009 $ & $ 0.00000002832152 $ \\
    \midrule
    $ 10^{-7} $ & $ 27140809 $ & $ 0.9999999999997 $ & $ -0.00000002055261 $ \\
    \arrayrulecolor{black}
    \bottomrule
  \end{tabular}
\end{table}

\end{frame}

\begin{frame}
\frametitle{Результаты интегрирования скоростей за цикл}

\begin{table}[h]
  \centering
  \caption{Сравнение результатов интегрирования скоростей за цикл}
  \begin{tabular}{cccc}
    \toprule
    $ h $ &
    $ n $ &
    $ v_{ab2}[1] $ &
    $ v_{ab2}[2] $ \\
    \midrule
    $ 10^{-2} $ & $ 271 $ & $ 0.15737122990461 $ & $ 0.45300615550211 $ \\
    \arrayrulecolor{black!40}
    \midrule
    $ 10^{-3} $ & $ 2714 $ & $ 0.00076998949004 $ & $ 0.49996341808806 $ \\
    \midrule
    $ 10^{-4} $ & $ 27141 $ & $ -0.00001339288816 $ & $ 0.49999996625940 $ \\
    \midrule
    $ 10^{-5} $ & $ 271408 $ & $ 0.00000099650822 $ & $ 0.49999999998835 $ \\
    \midrule
    $ 10^{-6} $ & $ 2714081 $ & $ -0.00000005836344 $ & $ 0.50000000000010 $ \\
    \midrule
    $ 10^{-7} $ & $ 27140809 $ & $ 0.00000004108792 $ & $ 0.50000000000004 $ \\
    \arrayrulecolor{black}
    \bottomrule
  \end{tabular}
\end{table}

\end{frame}

\begin{frame}
\frametitle{Результаты вычисления интеграла энергии}

Интеграл энергии вычисляется как

\su
\begin{equation}
  \frac{1}{2} v^2 - \frac{\varkappa^2}{r} = E = const.
\end{equation}

Для указанных начальных данных $ E = -0.875 $.

\begin{table}[h]
  \centering
  \caption{Сравнение результатов вычисления интеграла энергии}
  \begin{tabular}{cccc}
    \toprule
    $ h $ &
    $ n $ &
    $ E $ &
    $ \Delta E $ \\
    \midrule
    $ 10^{-2} $ & $ 10^2 $ & $ -0.8748722073707290 $ & $ 0.000127792629270984 $ \\
    \arrayrulecolor{black!40}
    \midrule
    $ 10^{-3} $ & $ 10^3 $ & $ -0.8749986881874487 $ & $ 0.000001311812551252 $ \\
    \midrule
    $ 10^{-4} $ & $ 10^4 $ & $ -0.8749999868440875 $ & $ 0.000000013155912471 $ \\
    \midrule
    $ 10^{-5} $ & $ 10^5 $ & $ -0.8749999998683713 $ & $ 0.000000000131628708 $ \\
    \midrule
    $ 10^{-6} $ & $ 10^6 $ & $ -0.8749999999985617 $ & $ 0.000000000001438294 $ \\
    \midrule
    $ 10^{-7} $ & $ 10^7 $ & $ -0.8749999999999362 $ & $ 0.000000000000063838 $ \\
    \arrayrulecolor{black}
    \bottomrule
  \end{tabular}
\end{table}

\end{frame}

\begin{frame}
\frametitle{Результаты вычисления интеграла энергии за цикл}

\begin{table}[h]
  \centering
  \caption{Сравнение результатов \\ вычисления интеграла энергии за цикл}
  \begin{tabular}{cccc}
    \toprule
    $ h $ &
    $ n $ &
    $ E $ &
    $ \Delta E $ \\
    \midrule
    $ 10^{-2} $ & $ 271 $ & $ -0.825054247099501 $ & $ 0.049945752900499 $ \\
    \arrayrulecolor{black!40}
    \midrule
    $ 10^{-3} $ & $ 2714 $ & $ -0.874940466010563 $ & $ 0.000059533989437 $ \\
    \midrule
    $ 10^{-4} $ & $ 27141 $ & $ -0.874999934733018 $ & $ 0.000000065266982 $ \\
    \midrule
    $ 10^{-5} $ & $ 271408 $ & $ -0.874999999878500 $ & $ 0.000000000121501 $ \\
    \midrule
    $ 10^{-6} $ & $ 2714081 $ & $ -0.874999999999061 $ & $ 0.000000000000939 $ \\
    \midrule
    $ 10^{-7} $ & $ 27140809 $ & $ -0.875000000000267 $ & $ 0.000000000000267 $ \\
    \arrayrulecolor{black}
    \bottomrule
  \end{tabular}
\end{table}

\end{frame}

\begin{frame}
\begin{figure}[h]
  \centering
  \includegraphics[scale=0.5]{orbit_0.01}
  \caption{Визуализация орбиты при $ h = 10^{-2} $, $ n = 10^2 $}
\end{figure}
\end{frame}

\begin{frame}
\begin{figure}[h]
  \centering
  \includegraphics[scale=0.5]{orbit_0.001}
  \caption{Визуализация орбиты при $ h = 10^{-3} $, $ n = 10^3 $}
\end{figure}
\end{frame}

\begin{frame}
\begin{figure}[h]
  \centering
  \includegraphics[scale=0.5]{orbit_0.0001}
  \caption{Визуализация орбиты при $ h = 10^{-4} $, $ n = 10^4 $}
\end{figure}
\end{frame}

\begin{frame}
\begin{figure}[h]
  \centering
  \includegraphics[scale=0.5]{orbit_1.0e-5}
  \caption{Визуализация орбиты при $ h = 10^{-5} $, $ n = 10^5 $}
\end{figure}
\end{frame}

\end{document}
